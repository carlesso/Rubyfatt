<%= content_for :breadcrumb do %>
  <%= print_breadcrumbs([ 
                      [t('breadcrumb.recurring_slips', :default => 'Recurring slips'), recurring_slips_path]
                    ]).html_safe %>
<% end %>

<%- model_class = RecurringSlip.new.class -%>
<h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
<table class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th><%=t model_class.human_attribute_name(:customer) %></th>
      <th><%=t model_class.human_attribute_name(:name) %></th>
      <th><%=t model_class.human_attribute_name(:rate) %></th>
      <th><%=t model_class.human_attribute_name(:rule) %></th>
      <th><%=t model_class.human_attribute_name(:next_occurrence) %></th>
      <th><%=t 'actions', :default => "Actions" %></th>
    </tr>
  </thead>
  <tbody>
    <% @recurring_slips.each do |slip| %>
      <tr>
        <td><%= slip.customer.title %></td>
        <td><%= slip.name %></td>
        <td><%= number_to_currency(slip.rate) %></td>
        <td><%= slip.schedule %></td>
        <td><span class="<%= 'label label-important' if slip.to_invoice? %>"><%= slip.next_occurrence ? slip.next_occurrence.in_time_zone("Rome").strftime("%d/%m/%Y") : '-' %></span></td>
        <td class="nowrap">
          <%= link_to(image_tag('icons/blog--plus.png', :alt => t('.create_invoice', :default => 'Create invoice'), :title => t('.create_invoice', :default => 'Create invoice')), new_recurring_slip_recurring_invoice_path(slip), :class => 'btn btn-mini' ) if slip.to_invoice? %>
          <%= link_to(image_tag('icons/document--pencil.png', :alt => t('.edit', :default => 'Edit recurring slip'), :title => t('.edit', :default => 'Edit recurring slip')), edit_recurring_slip_path(slip), :class => 'btn btn-mini') %>
          <%= link_to(image_tag('icons/cross-circle.png', :alt => t('.delete', :default => 'Delete recurring slip'), :title => t('.delete', :default => 'Delete recurring slip')), recurring_slip_path(slip), :method => :delete, :confirm => t('.delete_confirm', :default => "Are you sure to delete the recurring slip?"), :class => 'btn btn-mini') %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to t('.new', :default => t("helpers.links.new")),
            new_recurring_slip_path,
            :class => 'btn btn-primary' %>
